package br.com.lotto.service.frequencia.analise;

import java.util.Collection;
import java.util.List;
import java.util.concurrent.atomic.AtomicInteger;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import br.com.lotto.dao.MegaSenaRepository;
import br.com.lotto.dto.Configuracoes;
import br.com.lotto.entity.Megasena;
import br.com.lotto.service.Analize;

@Service
public class AnaliseFrequencia implements Analize {

	private Configuracoes configuracoes = new Configuracoes();

	@Autowired
	private MegaSenaRepository megaSenaRepository;

	@Override
	public void init() {
		Long countSorteio = this.megaSenaRepository.count();
		AtomicInteger i = new AtomicInteger(1);
		
		for (; i.get() < countSorteio.intValue(); i.incrementAndGet()) {
			Collection<Object[]> listaFrequ = this.megaSenaRepository.getFrequencia(i.get());
			Megasena jogoMegaSena = this.megaSenaRepository.getMegaSena(i.get() + 1);
			listaFrequ.stream().forEach(f -> {
				Object[] freq = f;
				System.out.println("Sorteio : " + i.get() + " - Número : " + freq[0] + " - Frequência : " + freq[1]);
			});

		}

	}

	public Configuracoes getConfigDefault() {

		// configuracoes.setMaisAtrazado(getnumRand());
		this.configuracoes.setMaisFrequente(
				this.configuracoes.getMaisFrequente() <= 60 && this.configuracoes.getMenosFrequente() == 60
						? this.configuracoes.getMaisFrequente() + 1 : this.configuracoes.getMaisFrequente());
		// configuracoes.setMenosAtrazado(getnumRand());
		this.configuracoes.setMenosFrequente(
				this.configuracoes.getMenosFrequente() < 60 ? this.configuracoes.getMenosFrequente() + 1 : 1);
		return configuracoes;
	}

}
